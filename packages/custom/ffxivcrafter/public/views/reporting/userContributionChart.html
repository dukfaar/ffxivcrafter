<md-card>
  <md-toolbar>
    <div class="md-toolbar-tools">
      <span>Contribution by User</span>
      <span flex></span>
      <md-menu>
        <md-button class="md-icon-button" aria-label="More" ng-click="$mdOpenMenu()">
          <md-icon class="material-icons">more_vert</md-icon>
        </md-button>
        <md-menu-content>
          <md-menu-item><md-switch ng-model="config.showDiagram">{{config.showDiagram?'Show':'Hide'}} Diagram</md-switch></md-menu-item>
        </md-menu-content>
      </md-menu>
    </div>
  </md-toolbar>
  <md-card-content layout="column">
    <div style="width:400px; height:400px;" ng-if="config.showDiagram">
      <canvas width="400" height="400" class="chart chart-pie" chart-data="chart.data" chart-labels="chart.labels" chart-options="chart.options"></canvas>
    </div>
    <table>
      <tr>
        <th>User</th>
        <th>Contribution</th>
        <th>Contribution%</th>
      </tr>
      <tr ng-repeat="entry in chart.dataArray | orderBy:'value':true">
        <td>{{entry.user}}</td>
        <td>{{entry.value.toFixed(2)}}</td>
        <td>{{((entry.value/chart.summedContribution)*100).toFixed(2)}} %</td>
      </tr>
    </table>

    <md-switch ng-model="functionData.showFormula">
      <span translate="{{functionData.showFormula?'reporting.formula.show':'reporting.formula.hide'}}"></span>
    </md-switch>

    <div ng-if="functionData.showFormula" layout="row">
      <md-list dnd-list="functionData.list">
        <h2 translate>reporting.formula.calculation</h2>
        <md-list-item
        ng-repeat="functionDescriptor in functionData.list"
        dnd-draggable="functionDescriptor"
        dnd-moved="functionData.list.splice($index,1)"
        dnd-effect-allowed="move"
        >
          <span flex>{{functionDescriptor.name}}</span>
          <md-button class="md-icon-button" ng-click="functionData.list.splice($index,1)">
            <md-icon class="material-icons">delete</md-icon>
          </md-button>
        </md-list-item>
      </md-list>

      <md-list dnd-list="functionDescriptors" dnd-disable-if="true">
        <h2 translate>reporting.formula.available.functions</h2>
        <md-list-item
        ng-repeat="functionDescriptor in functionDescriptors"
        dnd-draggable="functionDescriptor"
        dnd-effect-allowed="copy"
        >
          {{functionDescriptor.name}}
        </md-list-item>
      </md-list>
  </div>

  </md-card-content>
</md-card>
