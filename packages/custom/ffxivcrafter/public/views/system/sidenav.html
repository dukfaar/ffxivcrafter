<div layout="column" ng-controller="HeaderController as hdrctr">
  <h2 style="text-align: center" ng-if="!inElectronApp()">RainCollector</h2>

  <div class="mainMenu">
    <div ng-repeat="item in hdrctr.menus.main|orderBy:'weight?weight:9999'" ng-if="item.link || item.submenus.length > 0" layout="column">
      <md-button class="menuItem" ng-if="item.link" layout="row" aria-label="{{item.link}}" ui-route="/{{item.link}}" ng-class="{active: $uiRoute}"  ui-sref="{{item.link}}" mean-token="item.link">
        <span style>{{item.title}}</span>
        <span flex></span>
      </md-button>

      <a class="md-button menuItem" ng-if="!item.link" ng-disabled="true" layout="row">
        <span style>{{item.title}}</span>
        <span flex></span>
      </a>

      <div ng-if="item.submenus.length>0" layout="column" class="subMenu">
        <div ng-repeat="subitem in item.submenus|orderBy:'weight?weight:9999'" class="menuItem">
          <md-button layout="row" aria-label="{{subitem.link}}" ui-route="/{{subitem.link}}" ng-class="{active: $uiRoute}"  ui-sref="{{subitem.link}}" mean-token="subitem.link">
            <span>{{subitem.title}}</span>
            <span flex></span>
          </md-button>
        </div>
      </div>
    </div>
  </div>

  <style>
  .mainMenu .menuItem {
    font-size: 1.05em;
  }

  .subMenu {
    padding-left: 1em;
  }

  .mainMenu .menuItem .menuItem {
    font-size: 1.00em;
  }
  </style>

  <span flex></span>
  <md-button class="md-button" aria-label="Sign Up" ui-sref="auth.register" ng-if="!hdrctr.hdrvars.authenticated">
    Join
  </md-button>
  <md-button class="md-button" aria-label="Login" ui-sref="auth.login" ng-if="!hdrctr.hdrvars.authenticated">
    Login
  </md-button>

  <div layout="row" layout-align="start center" layout-padding>
    <language-select></language-select>
    <span flex></span>
    <md-menu ng-if="hdrctr.hdrvars.authenticated" md-position-mode="target-right target">
      <md-button aria-label="Account" class="md-button top-link" ng-click="$mdOpenMenu()">
        <md-tooltip md-direction="left">{{'settings.account'|translate}}</md-tooltip>
        <md-icon>account_box</md-icon>
        <span id="toolbar-username">{{hdrctr.hdrvars.user.name}}</span>
        <md-icon md-menu-origin>keyboard_arrow_down</md-icon>
      </md-button>

      <md-menu-content>
        <md-menu-item ui-route="/{{item.link}}" ng-class="{active: $uiRoute}" ng-repeat="item in hdrctr.menus.account">
            <md-button mean-token="item.link" ui-sref='{{item.link}}'>
              {{item.title}}
            </md-button>
        </md-menu-item>

        <md-menu-item>
          <md-button class="md-button" aria-label="Logout" ng-click="hdrctr.logout()">
            <md-icon>exit_to_app</md-icon>
            Logout
          </md-button>
        </md-menu-item>
      </md-menu-content>
    </md-menu>
  </div>
</div>
