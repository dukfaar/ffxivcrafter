<div ng-controller="ProjectController" flex>
  <main style="overflow:auto">
    <div flex>
      <md-content>
        <md-tabs flex md-dynamic-height md-border-bottom md-selected="tabdata.selectedIndex" ng-if="!tabdata.showProjectOverview || !tabdata.useOverview">
          <md-tab ng-click="clickProject(tabproject,$index)" ng-repeat="tabproject in tabList" label="{{(tabproject.name && tabproject.name!=='')?tabproject.name:tabproject.tree.item.name}}"></md-tab>
        </md-tabs>

        <column-layout ng-if="project && (!tabdata.showProjectOverview || !tabdata.useOverview)">
          <column>
            <project-recipe-tree-card></project-recipe-tree-card>
          </column>

          <column>
            <project-item-crafts project="project" project-data="projectData[project._id]"></project-item-crafts>
            <project-item-gathers project="project" project-data="projectData[project._id]"></project-item-gathers>
          </column>

          <column>
            <project-item-stock project="project" project-data="projectData[project._id]"></project-item-stock>
          </column>

          <column>
            <project-settings-card></project-settings-card>

            <revenue-card project="project" project-data="projectData[project._id]"></revenue-card>

            <md-card id="commentCard" ng-if="project.comment.length>0">
              <md-card-header>
                <md-card-header-text class="md-title" translate>
                  project.comment
                </md-card-header-text>
              </md-card-header>
              <md-card-content>
                {{project.comment}}
              </md-card-content>
            </md-card>

            <md-card>
              <md-card-header>
                <md-card-header-text class="md-title" translate>
                  project.notes
                </md-card-header-text>
              </md-card-header>
              <md-card-content layout="column">
                <md-input-container>
                  <textarea ng-change="updateProjectNotes(project)" ng-model-options="{debounce:300}" ng-model="project.notes"></textarea>
                </md-input-container>
              </md-card-content>
            </md-card>
          </column>
        </md-content>

        <md-content ng-if="tabdata.showProjectOverview && tabdata.useOverview" layout-padding>
          <md-grid-list md-cols="4" md-gutter="1em" md-row-height="13em">
            <md-grid-tile ng-repeat="tabproject in tabList">
              <md-card layout-fill>
                <md-toolbar ng-class="{'md-hue-1':!tabproject.private && tabproject.public, 'md-hue-2':tabproject.private, 'md-hue-3':tabproject.order}">
                  <div class="md-toolbar-tools">
                    <span>{{tabproject.name}}</span>
                  </div>
                </md-toolbar>

                <md-card-content flex style="overflow: auto;">
                  <div style="white-space: pre">{{tabproject.notes}}</div>
                </md-card-content>
                <md-divider></md-divider>

                <md-card-actions layout="row" layout-align="start center">
                  <div ng-if="tabproject.order">
                    <i><span translate>ordered.by</span> {{tabproject.creator.name}}</i>
                  </div>
                  <div flex></div>
                  <md-button ng-click="clickProject(tabproject,$index)" translate="go.to.project"></md-button>
                </md-card-actions>
              </md-card>
            </md-grid-tile>
          </md-grid-list>
        </md-content>
      </md-content>
    </div>
  </main>
</div>

<style>
.stepList {
  padding:0.5em 0 0.5em 0.5em;
}

.step select {
  border:0;
}

.md-errors-spacer:empty { display: none; }
</style>
